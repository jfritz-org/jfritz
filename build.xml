<?xml version="1.0" encoding="UTF-8"?>
<project default="jar">
	<property name="src" value="src"/>
	<property name="doc" value="doc"/>
	<property name="build" value="bin"/>
	<property name="dist" value="dist"/>
	<property name="source" value="source"/>
	<property name="lib" value="lib"/>
	<property name="ant.project.name" value = "JFritz! Documentation"/>
	<property name="jfritzdir" value="C:\Programme\JFritz"/>

	<!-- compiler flags -->
	<property name="javac.debug" value="true"/>
	<property name="javac.optimize" value="false"/>

	<!-- include all jars in lib to classpath -->
	<path id="classpath">
		<fileset dir="${lib}">
        	<include name="**/*.jar"/>
    	</fileset>
	</path>

	<target name="compile">
		<mkdir dir="${build}"/>
		<javac srcdir="${src}" destdir="${build}"  classpathref="classpath" debug="${javac.debug}"	optimize="${javac.optimize}"/>

		<!-- copy ressource-files -->
		<copy todir="${build}/de/moonflower/jfritz/resources"><fileset dir="${src}/de/moonflower/jfritz/resources"></fileset></copy>

		<!-- copy lib files -->
		<copy todir="${dist}/${lib}">
			<fileset dir="${lib}">
				<exclude name="**/*.java"/>
				<exclude name="jacob.dll"/>
	      </fileset>
	    </copy>
		<copy file="lib/jacob.dll" todir="${dist}"/>
	</target>

	<target name="jar" depends="compile">
		<mkdir dir="${dist}"/>
		<jar jarfile="${dist}/jfritz.jar" basedir="${build}" index="false">
		    <manifest>
		      <attribute name="Class-Path" value="${lib}/jdic.jar ${lib}/jfreereport-0.8.6-2.jar ${lib}/jcommon-1.0.0-rc1-cvs.jar ${lib}/itext-1.3.4.jar ${lib}/bsh-1.3.0.jar ${lib}/bsf-2.3.0.jar ${lib}/poi-2.5.1-final-20040804.jar ${lib}/jacob.jar"/>
		      <attribute name="Main-Class" value="de.moonflower.jfritz.JFritz"/>
		    </manifest>
		</jar>
	</target>

	<target name="javadoc" depends="compile,javadoc-init" description="Generate JavaDocs.">
	    <javadoc destdir="${doc}"
	    	access="public"
	    	author="true"
	    	version="true"
	    	use="true"
	    	windowtitle="${ant.project.name}"
	    	sourcepath="${src}"
	    	source="1.4"
	    	packagenames="de.moonflower.jfritz.*"
	    	classpath="lib"
	    	splitindex="true"
	    	verbose="false">
	        <doctitle><![CDATA[<h1>${ant.project.name}</h1>]]></doctitle>
	        <bottom>
	            <![CDATA[<i>Copyright &#169; 2005 All Rights Reserved.</i>]]>
	        </bottom>
<!--	    	<tag name="todo" description="To do:" scope="all" />  -->
	    </javadoc>
	</target>

	<target name="javadoc-init">
	    <mkdir dir="${doc}"/>
	</target>

	<target name="javadoc-clean">
	    <delete dir="${doc}"/>
	</target>

	<target name="javadoc-archive" depends="javadoc">
		<mkdir dir="${dist}"/>
		<tar tarfile="${dist}/jfritz-javadoc.tar" basedir="${doc}" />
		<gzip src="${dist}/jfritz-javadoc.tar" zipfile="${dist}/jfritz-javadoc.tar.gz"/>
		<delete file="${dist}/jfritz-javadoc.tar"/>
	</target>

	<target name="clean">
		<delete dir="${build}"/>
		<delete dir="${dist}"/>
	</target>

	<target name="update">
		<cvs command="update"/>
	</target>

	<target name="copyToFritzDir">
		<copy file="dist/jfritz.jar" todir="${jfritzdir}"/>
	</target>

	<target name="source">
		<mkdir dir="${dist}"/>
		<mkdir dir="${dist}/${source}"/>
		<mkdir dir="${dist}/${source}/tmp/${src}"/>
		<mkdir dir="${dist}/${source}/tmp/${src}"/>
		<copy todir="${dist}/${source}/tmp/${src}">
			<fileset dir="${src}">
				<include name="**/*.java"/>
	      	</fileset>
	    </copy>
		<mkdir dir="${dist}/${source}/tmp/${lib}"/>
		<copy todir="${dist}/${source}/tmp/${lib}">
			<fileset dir="${lib}">
				<include name="**/*.jar"/>
	      	</fileset>
	    </copy>
		<copy file="jacob.dll" todir="${dist}/${source}/tmp"/>
		<copy file="build.xml" todir="${dist}/${source}/tmp"/>
		<zip zipfile="${dist}/${source}/jfritz-source.zip" basedir="${dist}/${source}/tmp" />
	    <delete dir="${dist}/${source}/tmp"/>
	</target>

</project>
